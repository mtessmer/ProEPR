

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OpenMM Score Function for Amino Acid Repacking &mdash; chiLife  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Frequently Asked Questions" href="../faqs.html" />
    <link rel="prev" title="Analyzing MD simulations" href="12-Analyzing_MD_Simulations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            chiLife
              <img src="../_static/chiLife_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chilife.html">chiLife Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rotamer_ensemble.html">Side Chain Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rotamer_libraries.html">Rotamer Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../molsys.html">Molecular Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Utils</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01-Basic_Spin_Labeling.html">Basic Spin Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-Simple_SDSL_site_pair_screen.html">Simple SDSL site pair screen</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-SDSL_Site_Screen.html">SDSL Site Screen</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-Adding_custom_spin_labels.html">Adding Custom Spin Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-Repacking_with_MCMC_Sampling.html">Repacking with MCMC Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-Membrane_Docking.html">Membrane Docking</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-Custom_Energy_Function.html">Custom Energy Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="09-Bifunctional_Labels.html">Bifunctional Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="10-Nucleic_acid_labels.html">Nucleic acid labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="11-Arbitrary_molecular_labels.html">Arbitrary molecular labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="12-Analyzing_MD_Simulations.html">Analyzing MD simulations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">OpenMM Score Function for Amino Acid Repacking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">Frequently Asked Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chiLife</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../examples.html">Examples</a></li>
      <li class="breadcrumb-item active">OpenMM Score Function for Amino Acid Repacking</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/gallery/13-OpenMM_Score_Function.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="OpenMM-Score-Function-for-Amino-Acid-Repacking">
<h1>OpenMM Score Function for Amino Acid Repacking<a class="headerlink" href="#OpenMM-Score-Function-for-Amino-Acid-Repacking" title="Link to this heading"></a></h1>
<p>This example demonstrates how openMM can be used with chilife to perform side chain repacking. While this example currently only works with native amino acids it will ideally lead to a set of methods to integrate with non-canonical amino acids. Because this example integrates with OpenMM it does require it as a dependency. OpenMM is best installed via cond-forge.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linear_sum_assignment</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">chilife</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tempfile</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemporaryDirectory</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">openmm</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openmm.app</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Users\mhtes\micromamba\envs\openMM\Lib\site-packages\tqdm\auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">match_atoms</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">subject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Helper function to match openMM atoms with chilife RotamerEnsemble atoms since they will likely be in different orders and have different names.</span>
<span class="sd">    This works by looping through all rotamers and finding atom-pair matching that minimizes the RMSD between the RotamerEnsemble atoms and the OpenMM atoms.</span>
<span class="sd">    This operation is performed on every rotamer in the library and the best scoring pairing is used.&quot;&quot;&quot;</span>

    <span class="c1"># Initialize storage variables</span>
    <span class="n">dmin_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">dmap</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Loop through rotamers</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subject</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>

        <span class="c1"># Create pairwise distance  metrix between atoms</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">reference</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">-</span> <span class="n">sub</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">*</span> <span class="n">diff</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Identify best pairing</span>
        <span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span><span class="n">linear_sum_assignment</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">)]</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">diff</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>

        <span class="c1"># Compare with previous best and store if necessary</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="n">dmin_score</span><span class="p">:</span>
            <span class="n">dmap</span> <span class="o">=</span> <span class="n">idx2</span>
            <span class="n">dmin_score</span> <span class="o">=</span> <span class="n">score</span>

    <span class="k">return</span> <span class="n">dmap</span>


<span class="k">class</span><span class="w"> </span><span class="nc">OpenMMEnergyFunc</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Score function for repacking. Note that this function uses the amber14 forcefield which does not parameterize any spin labels or most other NCAAs used by chilife. This examples uses only Natrual amino acids to demonstrate</span>
<span class="sd">    How chiLife can be integrated with OpenMM. &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protein</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This object will take in a single protein. This protein should have all atoms present (including hydrogen atoms) with no heterogens or other abnormalities. A structure like this can be prepared with something like PDBFixer.</span>
<span class="sd">        For each site the structure should already be mutated to the appropriate amino acid you wish to model. This can be done using the ``xl.mutate`` function. During construction an OpenMM.Simulation object will be created</span>
<span class="sd">        which can be re-used for all RotamerEnsembles being attached to this protein&quot;&quot;&quot;</span>

        <span class="n">protein</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protein</span> <span class="o">=</span> <span class="n">protein</span>

        <span class="c1"># Write protein to temporary file to load in with OpenMM PDBFile for quick and easy topology and parameterization</span>
        <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tempdir</span><span class="p">:</span>
            <span class="n">xl</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tempdir</span><span class="si">}</span><span class="s1">/tmp.pdb&#39;</span><span class="p">,</span> <span class="n">protein</span><span class="p">)</span>
            <span class="n">pdb</span> <span class="o">=</span> <span class="n">PDBFile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tempdir</span><span class="si">}</span><span class="s1">/tmp.pdb&#39;</span><span class="p">)</span>

        <span class="c1"># Use Amber14 forcefield with GBN2 implicit solvent model</span>
        <span class="n">ff</span> <span class="o">=</span> <span class="n">ForceField</span><span class="p">(</span><span class="s1">&#39;amber14-all.xml&#39;</span><span class="p">,</span> <span class="s1">&#39;implicit/gbn2.xml&#39;</span><span class="p">)</span>

        <span class="c1"># Use only non-bonded forces since bonded forces of the protein will not change and bonded forces of the rotamers should be accounted for in the library.</span>
        <span class="n">ff</span><span class="o">.</span><span class="n">_forces</span> <span class="o">=</span> <span class="p">[</span><span class="n">force</span> <span class="k">for</span> <span class="n">force</span> <span class="ow">in</span> <span class="n">ff</span><span class="o">.</span><span class="n">_forces</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">forcefield</span><span class="o">.</span><span class="n">NonbondedGenerator</span><span class="p">)]</span>

        <span class="c1"># Create and store simulation object for energy calculations</span>
        <span class="n">omm_system</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">createSystem</span><span class="p">(</span><span class="n">pdb</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">nonbondedMethod</span><span class="o">=</span><span class="n">CutoffNonPeriodic</span><span class="p">,</span> <span class="n">nonbondedCutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">nanometer</span><span class="p">)</span>
        <span class="n">integrator</span> <span class="o">=</span> <span class="n">LangevinMiddleIntegrator</span><span class="p">(</span><span class="mi">300</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">kelvin</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">unit</span><span class="o">.</span><span class="n">picosecond</span><span class="p">,</span> <span class="mf">0.004</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">picoseconds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">pdb</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">omm_system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>



    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>

        <span class="c1"># Identify and store system indices that correspond to the rotamer ensemble</span>
        <span class="n">psel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protein</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">selstr</span><span class="p">)</span>
        <span class="n">system</span><span class="o">.</span><span class="n">efunc_protein_ix</span> <span class="o">=</span> <span class="n">psel</span><span class="o">.</span><span class="n">ix</span>
        <span class="n">system</span><span class="o">.</span><span class="n">efunc_residue_ix</span> <span class="o">=</span> <span class="n">match_atoms</span><span class="p">(</span><span class="n">psel</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Only requirement for a chilife energy  function is to accept a ``system`` and return an energy score in kcal/mol for each rotamer in that system.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">system</span><span class="p">,</span>  <span class="s1">&#39;efunc_protein_ix&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prepare_system</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>

        <span class="n">pose_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protein</span><span class="o">.</span><span class="n">positions</span>

        <span class="n">Es</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rot</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
            <span class="n">pose_start</span><span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">efunc_protein_ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot</span><span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">efunc_residue_ix</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setPositions</span><span class="p">(</span><span class="n">pose_start</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">angstrom</span><span class="p">)</span>
            <span class="n">energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">getEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">getPotentialEnergy</span><span class="p">()</span><span class="o">.</span><span class="n">value_in_unit</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">kilocalorie_per_mole</span><span class="p">)</span>
            <span class="n">Es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>

        <span class="n">Es</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Es</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Es</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load in protein object</span>
<span class="n">protein</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">load_protein</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># Create Energy function unique to this protein</span>
<span class="n">omm_efunc</span> <span class="o">=</span> <span class="n">OpenMMEnergyFunc</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>

<span class="c1"># Create a rotamer ensemble of at lysine 48 using ORS and the new energy function</span>
<span class="n">RL</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">RotamerEnsemble</span><span class="p">(</span><span class="s1">&#39;LYS&#39;</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">use_H</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">energy_func</span><span class="o">=</span><span class="n">omm_efunc</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform repacking around the new rotamer library using the same energy function</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">de</span> <span class="o">=</span> <span class="n">xl</span><span class="o">.</span><span class="n">repack</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">RL</span><span class="p">,</span> <span class="n">energy_func</span><span class="o">=</span><span class="n">omm_efunc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|████████████████████████████████████████████████████████████████████████████████| 200/200 [00:03&lt;00:00, 52.54it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">de</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Change in energy (kcal/mol)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/gallery_13-OpenMM_Score_Function_5_0.png" src="../_images/gallery_13-OpenMM_Score_Function_5_0.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="12-Analyzing_MD_Simulations.html" class="btn btn-neutral float-left" title="Analyzing MD simulations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../faqs.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Maxx Tessmer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>